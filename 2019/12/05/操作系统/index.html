<!DOCTYPE html>
<html lang="en">

<!-- Head tag (contains Google-Analytics、Baidu-Tongji)-->
<head>
  <!-- Google Analytics -->
  
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-xxxxxx-xx"></script>
  <script type="text/javascript">
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }
    gtag('js', new Date());

    gtag('config', 'UA-xxxxxx-xx');
  </script>
  

  <!-- Baidu Tongji -->
  
  <script type="text/javascript">
    // Originial
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>
  

  <!-- Baidu Push -->
  
  <script>
    (function() {
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
      } else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>
  

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />

  <meta name="google-site-verification" content="lxDfCplOZbIzjhG34NuQBgu2gdyRlAtMB4utP5AgEBc" />
  <meta name="baidu-site-verification" content="PpzM9WxOJU" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="It&#39;s an IT blog..." />
  <meta name="keyword" content="Time" />
  <link rel="shortcut icon" href="/img/avatar/roguerabbit.jpg" />

  <!-- Place this tag in your head or just before your close body tag. -->
  <script async="async" defer="defer" src="https://buttons.github.io/buttons.js"></script>
  <!-- Bootstrap Core CSS -->
  <link rel="stylesheet" href="/css/bootstrap.min.css" />

  <!-- Custom CSS -->
  <link rel="stylesheet" href="/css/beantech.min.css" />

  <!-- Pygments Highlight CSS -->
  
<link rel="stylesheet" href="../../../../css/highlight.css">
<link rel="stylesheet" href="../../../../css/widget.css">
<link rel="stylesheet" href="../../../../css/rocket.css">
<link rel="stylesheet" href="../../../../css/signature.css">
<link rel="stylesheet" href="../../../../css/catalog.css">
<link rel="stylesheet" href="../../../../css/livemylife.css">


  
  <!-- wave start -->
  <link rel="stylesheet" href="/css/wave.css" />
  <!-- wave end -->
  

  
  <!-- top start (article top hot config) -->
  <link rel="stylesheet" href="/css/top.css" />
  <!-- top end -->
  

  
  <!-- ThemeColor start -->
  <link rel="stylesheet" href="/css/scroll.css" />
  <!-- ThemeColor end -->
  

  
  <!-- viewer start (Picture preview) -->
  <link rel="stylesheet" href="/css/viewer.min.css" />
  <!-- viewer end -->
  

  
  <!-- Search start -->
  <link rel="stylesheet" href="/css/search.css" />
  <!-- Search end -->
  

  
  <!-- ThemeColor start -->
  <link rel="stylesheet" href="/css/themecolor.css" />
  <!-- ThemeColor end -->
  

  

  
  <!-- gitalk start -->
  <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css"> -->
  <link rel="stylesheet" href="/css/gitalk.css" />
  <!-- gitalk end -->
  

  <!-- Custom Fonts -->
  <!-- <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
  <!-- Hux change font-awesome CDN to qiniu -->
  <link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.5.0/css/font-awesome.min.css" type="text/css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  <!-- Hux Delete, sad but pending in China <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'> <link
    href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/ css'> -->

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]> <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script> <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script> <![endif]-->

  <!-- ga & ba script hoook -->
  <link rel="canonical" href="http://yoursite-url/2019/12/05/操作系统/">
  <title>
    
    操作系统 - Bolg
    
  </title>
<meta name="generator" content="Hexo 4.2.1"></head>


<!-- hack iOS CSS :active style -->

<body ontouchstart="" class="body--home">
	<!-- ThemeColor -->
	
	<!-- ThemeColor -->
<!-- <div class="toggle" onclick="document.body.classList.toggle('body--dark')">Switch Color</div> -->

<div class="toggle" onclick="document.body.classList.toggle('body--dark')">
  <i class="mdui-icon material-icons bright-mode"></i>
  <i class="mdui-icon material-icons dark-mode"></i>
</div>

	

	<!-- Gitter -->
	
	<!-- Gitter -->
<!-- Docs:https://gitter.im/?utm_source=left-menu-logo -->
<script>
  ((window.gitter = {}).chat = {}).options = {
    room: 'your-community/your-room'
  };
</script>
<script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script>

	

	<!-- Navigation (contains search)-->
	<!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header page-scroll">
      <button type="button" class="navbar-toggle">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">所爱隔山海</a>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
    <div id="huxblog_navbar">
      <div class="navbar-collapse">
        <ul class="nav navbar-nav navbar-right">
          <li>
            <a href="/">Home</a>
          </li>

          

          
          

          
          <li>
            <a href="/archive/">Archives</a>
          </li>
          
          

          
          <li>
            <a href="/about/">About</a>
          </li>
          
          

          
          <li>
            <a href="/tags/">Tags</a>
          </li>
          
          

          
          <li>
            <a href="/categories/">Categories</a>
          </li>
          
          

          
          <li><a class="popup-trigger" title="Search"><span class="search-icon"></span>Search</a></li>
          
        </ul>
      </div>
    </div>
    <!-- /.navbar-collapse -->
  </div>
  <!-- /.container -->
</nav>
<!-- progress -->
<div id="progress">
  <div class="line" style="width: 0%;"></div>
</div>


<script>
  // Drop Bootstarp low-performance Navbar
  // Use customize navbar with high-quality material design animation
  // in high-perf jank-free CSS3 implementation
  var $body = document.body;
  var $toggle = document.querySelector('.navbar-toggle');
  var $navbar = document.querySelector('#huxblog_navbar');
  var $collapse = document.querySelector('.navbar-collapse');

  $toggle.addEventListener('click', handleMagic)

  function handleMagic(e) {
    if ($navbar.className.indexOf('in') > 0) {
      // CLOSE
      $navbar.className = " ";
      // wait until animation end.
      setTimeout(function() {
        // prevent frequently toggle
        if ($navbar.className.indexOf('in') < 0) {
          $collapse.style.height = "0px"
        }
      }, 400)
    } else {
      // OPEN
      $collapse.style.height = "auto"
      $navbar.className += " in";
    }
  }
</script>


	<!-- Post Header (contains intro-header、signature、wordcount、busuanzi、waveoverlay) -->
	<!-- Modified by Yu-Hsuan Yen -->
<!-- Post Header -->

  <style type="text/css">
    header.intro-header {
       /*post*/
        background-image: url('');
      
    }

    
      #signature {/*signature*/
        background-image: url('/img/signature/vincent-white.png');
      }
    
  </style>





<header class="intro-header">
  <!-- Signature -->
  <div id="signature">
    <div class="container">
      <div class="row">
        <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
          
          <div class="post-heading">
            <div class="tags">
              
              <a class="tag" href="/tags/#操作系统" title="操作系统">操作系统</a>
              
            </div>
            <h1>操作系统</h1>
            <h2 class="subheading"></h2>
            <span class="meta">
              Posted by 余腾 on
              2019-12-05
            </span>


            
            <!-- WordCount start -->
            <div class="blank_box"></div>
            <span class="meta">
              Estimated Reading Time <span class="post-count">15</span> Minutes
            </span>
            <div class="blank_box"></div>
            <span class="meta">
              Words <span class="post-count">4.4k</span> In Total
            </span>
            <div class="blank_box"></div>
            <!-- 不蒜子统计 start -->
            <span class="meta">
              Viewed <span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span> Times
            </span>
            <!-- 不蒜子统计 end -->
            <!-- WordCount end -->
            


          </div>
          
        </div>
      </div>
    </div>
  </div>

  
  <!-- waveoverlay start -->
  <div class="preview-overlay">
    <svg class="preview-waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
      <defs>
        <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"></path>
      </defs>
      <g class="preview-parallax">
        <use xlink:href="#gentle-wave" x="48" y="0" fill=var(--gentle-wave1)></use>
        <use xlink:href="#gentle-wave" x="48" y="3" fill=var(--gentle-wave2)></use>
        <use xlink:href="#gentle-wave" x="48" y="5" fill=var(--gentle-wave3)></use>
        <use xlink:href="#gentle-wave" x="48" y="7" fill=var(--gentle-wave)></use>
      </g>
    </svg>
  </div>
  <!-- waveoverlay end -->
  

</header>



	<!-- Main Content (Post contains
	Pager、
	tip、
	socialshare、
	gitalk、gitment、disqus-comment、
	Catalog、
	Sidebar、
	Featured-Tags、
	Friends Blog、
	anchorjs、
	) -->
	<!-- Modify by Yu-Hsuan Yen -->
<!-- Post Content -->
<article>
  <div class="container">
    <div class="row">
      <!-- Post Container -->
      <div class="col-lg-8 col-lg-offset-1 col-md-10 col-md-offset-1 post-container">

        <hr>
<h1 id="操作系统"><a href="#操作系统" class="headerlink" title="操作系统"></a>操作系统</h1><h2 id="一、"><a href="#一、" class="headerlink" title="一、"></a>一、</h2><h2 id="二、进程（Process）"><a href="#二、进程（Process）" class="headerlink" title="二、进程（Process）"></a>二、进程（Process）</h2><h3 id="2-1、进程的概念"><a href="#2-1、进程的概念" class="headerlink" title="2.1、进程的概念"></a>2.1、进程的概念</h3><ul>
<li><strong>计算机中一个具有独立功能的程序关于某数据集合上的一次动态执行过程。</strong></li>
<li><strong>操作系统进行资源分配和调度的基本单位，以及操作系统结构的基础。</strong></li>
</ul>
<h3 id="2-2、进程的组成"><a href="#2-2、进程的组成" class="headerlink" title="2.2、进程的组成"></a>2.2、进程的组成</h3><ul>
<li>程序代码；</li>
<li>程序处理的数据；</li>
<li>程序计数器中的值，指示下一条将运行的指令；</li>
<li>一组通用的寄存器的当前值，堆、栈;</li>
<li>一组系统资源（如内存资源，打开的文件，网络）；</li>
<li>总之，进程包含了正在运行的一个程序的所有状态信息。</li>
</ul>
<h3 id="2-3、进程与程序的联系"><a href="#2-3、进程与程序的联系" class="headerlink" title="2.3、进程与程序的联系"></a>2.3、进程与程序的联系</h3><ul>
<li>进程 ≠ 程序</li>
<li>程序是产生进程的基础；</li>
<li>程序的每次运行构成不同的进程；</li>
<li>进程是程序功能的体现；</li>
<li>通过多次执行，一个程序可对应多个进程；通过调用关系，一个进程可包括多个程序。</li>
</ul>
<p><strong>类比：有一个计算机科学家，想亲手给女儿做一个生日蛋糕。所以他就找了一本有关做蛋糕的食谱，买了一些原料，面粉、鸡蛋、糖、香料等，然后边看边学边做。这时小儿子哭着跑进来，说手被蜜蜂蛰了。教授只好把蛋糕先放在一边。他在食谱上做了个标记，把状态信息记录了起来。然后又去找了一本医疗手册，查到了相关的内容，按照上面的指令一步步地执行。 当伤口处理完之后，又回到厨房继续做蛋糕。</strong></p>
<ul>
<li>食谱 = 程序</li>
<li>原料 = 数据</li>
<li>科学家 = CPU</li>
<li>做蛋糕 = 进程</li>
<li>CPU从一个进程（做蛋糕）切换（中断进程）到另一个进程（医疗救护 —&gt; 优先级更高）</li>
</ul>
<p>2.4、进程与程序的区别</p>
<table>
<thead>
<tr>
<th align="center">进程</th>
<th align="center">程序</th>
</tr>
</thead>
<tbody><tr>
<td align="center">动态/状态变化的过程</td>
<td align="center">静态/永久保存</td>
</tr>
<tr>
<td align="center">进程是程序的执行</td>
<td align="center">程序是有序代码的集合</td>
</tr>
<tr>
<td align="center">核心态/用户态</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">暂时性/运行性</td>
<td align="center">永久性</td>
</tr>
</tbody></table>
<h3 id="2-5、进程的特点"><a href="#2-5、进程的特点" class="headerlink" title="2.5、进程的特点"></a>2.5、进程的特点</h3><p>动态性：可动态地创建，结束进程。<br>并发性：进程可以被独立调度并占用处理器运行。<br>独立性：不同进程的工作不互相影响（操作系统保证，内存管理页表）。<br>制约性：因访问共享数据/资源或进程间同步而产生制约。</p>
<h3 id="2-6、进程控制块-PCB"><a href="#2-6、进程控制块-PCB" class="headerlink" title="2.6、进程控制块 PCB"></a>2.6、进程控制块 PCB</h3><p>程序 = 算法 + 数据结构</p>
<ul>
<li><p><strong>描述进程的数据结构：进程控制块 （Process Control Block，PCB）</strong></p>
<ul>
<li><strong>操作系统为每个进程都维护了一个 PCB ，用来保存与进程有关的各种状态信息。</strong></li>
</ul>
</li>
<li><p><strong>进程控制块：操作系统管理控制进程运行所用的信息集合。</strong></p>
<ul>
<li>操作系统用 PCB 来描述进程的基本情况以及运行变化的过程。</li>
<li><strong><code>PCB 是进程存在的唯一标识。</code></strong></li>
</ul>
</li>
</ul>
<p><strong>进程的创建：为该进程生成一个 PCB；</strong><br><strong>进程的终止：回收它的PCB;</strong><br><strong>进程的组织管理：通过对PCB的组织管理来实现;</strong></p>
<p><strong>PCB 含有以下三大类信息：</strong> </p>
<ul>
<li><p><strong>1、进程标识信息，如本进程标识，本进程的父进程标识，用户标识。</strong></p>
</li>
<li><p><strong>2、处理机状态信息保存区，保存进程的运行现场信息。</strong></p>
<ul>
<li>用户可见寄存器</li>
<li>控制和状态寄存器</li>
<li>栈指针</li>
</ul>
</li>
<li><p><strong>3、进程控制信息</strong></p>
<ul>
<li>调度和状态信息，用于操作系统调度进程并占用处理机使用。</li>
<li>进程间通信信息，为支持进程间的与通信相关的各种标识、信号、信件等,<br>这些信息存在接收方的进程控制块中。</li>
<li>存储管理信息，包含有指向本进程映像存储空间的数据结构。</li>
<li>进程所用资源，说明由进程打开、使用的系统资源，如打开的文件等。</li>
<li>有关数据结构连接信息，进程可以连接到一个进程队列中，或连接到相关<br>的其他进程的PCB。</li>
</ul>
</li>
</ul>
<h3 id="2-7、进程的生命周期"><a href="#2-7、进程的生命周期" class="headerlink" title="2.7、进程的生命周期"></a>2.7、进程的生命周期</h3><h4 id="2-7-1、进程生命周期管理"><a href="#2-7-1、进程生命周期管理" class="headerlink" title="2.7.1、进程生命周期管理"></a>2.7.1、进程生命周期管理</h4><ul>
<li><code>进程创建</code> =&gt; 三个主要条件<ul>
<li>系统初始化时；init 进程</li>
<li>用户请求创建一个新的进程；</li>
<li>正在运行的进程执行了创建进程的系统调用；</li>
</ul>
</li>
<li><code>进程运行</code> <ul>
<li>内核选择一个就绪的进程，让它占用处理机并执行；</li>
<li>如何选择？=&gt; 系统调度</li>
</ul>
</li>
<li><code>进程等待（阻塞）</code><ul>
<li>请求并等待系统服务，无法马上完成；</li>
<li>启动某种操作，无法马上完成；</li>
<li>需要的数据没有到达；</li>
</ul>
</li>
<li><code>进程唤醒</code><ul>
<li>进程只能被别的进程唤醒或操作系统唤醒；</li>
<li>被阻塞进程需要的资源可以被满足；</li>
<li>被阻塞进程等待的事件到达；</li>
<li>将该进程的PCB插入到就绪队列；</li>
</ul>
</li>
<li><code>进程结束</code><ul>
<li>正常退出</li>
<li>错误退出</li>
<li>致命错误</li>
<li>被其他进程 kill</li>
</ul>
</li>
</ul>
<h4 id="2-7-2、进程状态变化模型"><a href="#2-7-2、进程状态变化模型" class="headerlink" title="2.7.2、进程状态变化模型"></a>2.7.2、进程状态变化模型</h4><p>进程在生命结束前处于且仅处于三种基本状态之一，不同系统设置的进程状态数目不同。</p>
<ul>
<li>创建状态（New）：一个进程正在被创建，还没有初始化完成没有转到就绪状态之前。<ul>
<li>NULL —&gt; New：一个新进程被产生出来执行一个程序。</li>
<li>New —&gt; Ready：当进程被创建完成并初始化后，一切准备就绪运行时变为就绪状态。</li>
</ul>
</li>
<li><code>就绪状态（Ready）</code>：一个进程获得除处理机之外的一切所需资源，一旦得到处理机即可运行。</li>
<li><code>运行状态（Running）</code>：一个进程正在处理机上运行时。</li>
<li><code>等待状态（又称阻塞状态 Blocked）</code>：一个进程正在等待某一事件而暂停运行时。如等待某资源，等待输入输出完成。</li>
<li>结束状态（Exit）：一个进程正在从系统中消失的状态。</li>
</ul>
<p><img src="../../img/articleImg/OS-Process-1.png" alt=""></p>
<h4 id="2-7-3、进程挂起模式"><a href="#2-7-3、进程挂起模式" class="headerlink" title="2.7.3、进程挂起模式"></a>2.7.3、进程挂起模式</h4><p>进程在挂起状态时，意味着进程没有占用内存空间。处于挂起状态的进程映像在磁盘上。</p>
<p><strong>挂起状态</strong></p>
<ul>
<li><strong><code>阻塞挂起状态（Block-Suspend）</code>：进程在外存并等待某事件的出现；</strong></li>
<li><strong><code>就绪挂起状态（Ready-Suspend）</code>：进程在外存，但只要进入内存，即可运行；</strong></li>
</ul>
<p><img src="../../img/articleImg/OS-Process-2.png" alt=""></p>
<p><strong>挂起状态相关的转换</strong></p>
<p>挂起(Suspend) ：把一个进程从内存转到外存；可能有以下几种情况</p>
<ul>
<li><p><strong>阻塞到阻塞挂起：</strong> 没有进程处于就绪状态或就绪进程要求更多内存资源时，<br>会进行这种转换，以提交新进程或运行就绪进程；</p>
</li>
<li><p><strong>就绪到就绪挂起：</strong> 当有高优先级阻塞(系统认为会很快就绪的)进程和低优先<br>就绪进程时，系统会选择挂起低优先级就绪进程；</p>
</li>
<li><p><strong>运行到就绪挂起：</strong> 对抢先式分时系统，当有高优先级阻塞挂起进程因事件出<br>现而进入就绪挂起时，系统可能会把运行进程转到就绪挂起状态；</p>
</li>
</ul>
<p><strong>在外存时的状态转换</strong></p>
<ul>
<li><strong>阻塞挂起到就绪挂起：</strong> 当有阻塞挂起进程因相关事件出现时，系统会把阻塞<br>挂起进程转换为就绪挂起进程。虽然已经转为就绪状态，但资源还在外存。</li>
</ul>
<p><strong>解挂/激活（Active）</strong></p>
<p>把一个程序从外存转到内存；</p>
<ul>
<li><strong>就绪挂起到就绪：</strong> 没有就绪进程或挂起就绪进程优先级高于就绪进程时，会进<br>行这种转换;</li>
<li><strong>阻塞挂起到阻塞：</strong> 当一个进程释放足够内存时，系统会把一个高优先级阻塞挂<br>起(系统认为会很快出现所等待的事件)进程转换为阻塞进程;</li>
</ul>
<p><strong>OS通过 PCB 和进程的状态管理PCB</strong></p>
<p><img src="../../img/articleImg/OS-Process-3.png" alt=""></p>
<h4 id="2-7-4、进程状态队列"><a href="#2-7-4、进程状态队列" class="headerlink" title="2.7.4、进程状态队列"></a>2.7.4、进程状态队列</h4><ul>
<li>由操作系统来维护<code>一组队列</code>，用来表示系统当中所有进程的当前状态；</li>
<li>不同的状态分别用不同的队列来表示(就绪队列、各种类型的阻塞队列) ；</li>
<li>每个进程的PCB都根据它的状态加入到相应的队列当中，当一个进程的状态发生<br>变化时，它的PCB从一个状态队列中脱离出来，加入到另外一个队列。</li>
</ul>
<p><img src="../../img/articleImg/OS-Process-4.png" alt=""></p>
<h4 id="2-7-5、进程的上下文切换"><a href="#2-7-5、进程的上下文切换" class="headerlink" title="2.7.5、进程的上下文切换"></a>2.7.5、进程的上下文切换</h4><p><strong>由于CPU时间片运行结束，暂停当前运行进程，从运行状态变成其他状态，</strong><br><strong>并且调度另一个进程，从就绪状态变成运行状态，称为一次上下文切换。</strong></p>
<ul>
<li>切换前，保存进程上下文信息到 PCB<ul>
<li>寄存器</li>
<li>CPU状态</li>
<li>内存地址空间</li>
</ul>
</li>
<li>切换后，从PCB里获取进程信息恢复进程上下文</li>
<li>快速切换（汇编实现）<ul>
<li><code>fork(); //创建子进程</code><ul>
<li>对子进程分配内存</li>
<li>复制父进程的内存和CPU寄存器到子进程里</li>
<li>开销昂贵</li>
</ul>
</li>
<li><code>exec(); //加载程序取代当前运行的进程</code></li>
<li><code>wait();  //父进程等待子进程结束</code><ul>
<li>使父进程去睡眠来等待子进程的结果。</li>
<li>当子进程调用exit()时候，OS解锁父进程，并且将通过exit()传递得到的返回值作为wait调用的一个结果（连同子进程的pid一起）如果这里没有子进程存活， wait()立刻返回。</li>
</ul>
</li>
<li><code>exit();</code> //进入僵尸状态，等待父进程回收子进程资源</li>
</ul>
</li>
</ul>
<p><img src="../../img/articleImg/OS-Process-5.png" alt=""></p>
<h3 id="2-8、进程间通信-IPC"><a href="#2-8、进程间通信-IPC" class="headerlink" title="2.8、进程间通信  IPC"></a><code>2.8、进程间通信  IPC</code></h3><p><strong>Inter-Process Communication</strong></p>
<p>发送路径：直接、间接</p>
<p>消息传递：阻塞、非阻塞  </p>
<ul>
<li>信号（Signal）：软件终端通知事件处理；不能传输要交换的任何数据；<ul>
<li>Catch：指定信号处理函数被调用；</li>
<li>Ignore：依靠操作系统的默认操作；</li>
<li>Mask：闭塞信号，因此不会传送；</li>
</ul>
</li>
<li>管道<ul>
<li>传输数据；</li>
</ul>
</li>
<li>消息队列<ul>
<li>FIFO</li>
</ul>
</li>
<li><h2 id="共享内存"><a href="#共享内存" class="headerlink" title="共享内存"></a>共享内存</h2><ul>
<li>每个进程都有私有地址空间；</li>
<li>每个地址空间内，明确地设置了共享内存段；</li>
<li>直接通讯；</li>
<li>快速方便地共享数据；</li>
<li>必须同步数据访问；</li>
</ul>
</li>
<li>Socket</li>
</ul>
<h3 id="2-9、线程（Thread）"><a href="#2-9、线程（Thread）" class="headerlink" title="2.9、线程（Thread）"></a>2.9、线程（Thread）</h3><p>为什么需要线程？</p>
<ul>
<li>进程之间如何通讯，共享数据；</li>
<li>进程开销比较大，分配资源，创建PCB；</li>
<li>撤销进程时，回收资源，撤销 PCB；</li>
<li>进程切换时，保存当前进程的状态信息等；</li>
</ul>
<h4 id="2-9-1、线程的概念"><a href="#2-9-1、线程的概念" class="headerlink" title="2.9.1、线程的概念"></a>2.9.1、线程的概念</h4><ul>
<li><strong>进程当中的一条执行流程。</strong></li>
<li><strong>线程 = 进程 - 共享资源</strong></li>
<li><strong>进程是操作系统资源分配的基本单位，而线程是 CPU 任务调度和执行的基本单位</strong>。</li>
</ul>
<p><strong>优点：</strong></p>
<ul>
<li>一个进程中可以同时存在多个线程；</li>
<li>各个线程之间可以并发地执行；</li>
<li>各个线程之间可以共享地址空间和文件等资源。</li>
</ul>
<p><strong>缺点：</strong></p>
<ul>
<li>一个线程崩溃，会导致其所属进程的所有线程崩溃。</li>
</ul>
<h4 id="2-9-2、线程的实现"><a href="#2-9-2、线程的实现" class="headerlink" title="2.9..2、线程的实现"></a>2.9..2、线程的实现</h4><p><strong>用户线程：在用户空间实现。操作系统看不到的线程。</strong></p>
<ul>
<li><p>TCB （Thread Control Block）在用户线程里面。</p>
</li>
<li><p>缺点：如果一个进程中的某个线程阻塞，除非它自己主动交出CPU使用权，<br>否则它所在的进程当中的其他线程将无法继续运行。由于时间片分配给的进<br>程，每个线程得到的时间片更少，执行会较慢。</p>
</li>
</ul>
<p><strong>内核线程：在内核中实现。操作系统管理起来的线程。</strong></p>
<ul>
<li><p>TCB （Thread Control Block）在内核里面。</p>
</li>
<li><p>内核线程是指在操作系统的内核当中实现的一种线程机制，由操作系统的内<br>核来完成线程的创建，终止和管理。</p>
</li>
</ul>
<p><strong>轻量级进程：在内核中实现，支持用户线程。</strong></p>
<ul>
<li>一个进程可有一个或多个轻量级进程，每个量级进程由一个单独的内核线程来支持。</li>
</ul>
<h4 id="2-9-3、死锁"><a href="#2-9-3、死锁" class="headerlink" title="2.9..3、死锁"></a>2.9..3、死<strong>锁</strong></h4><p><strong><code>资源互斥、请求保持、不可剥夺、循环等待</code></strong></p>
<ul>
<li>银行家算法  =&gt; 开销较大、一般用来做调试；<ul>
<li>要知道每个线程需要资源多少</li>
</ul>
</li>
<li>死锁检测算法</li>
</ul>
<h4 id="2-9-4、死锁恢复"><a href="#2-9-4、死锁恢复" class="headerlink" title="2.9..4、死锁恢复"></a>2.9..4、死锁恢复</h4><ul>
<li>选择一个受害者  —  最小的成本；</li>
<li>回滚  —  返回到一些安全状态，重启进程到安全状态；</li>
<li>饥饿  —  同一进程可能一直被选作受害者，包括回滚的数量；</li>
</ul>
<h2 id="三、调度"><a href="#三、调度" class="headerlink" title="三、调度"></a>三、调度</h2><h3 id="3-1、调度原则"><a href="#3-1、调度原则" class="headerlink" title="3.1、调度原则"></a>3.1、调度原则</h3><ul>
<li><code>CPU使用率</code><ul>
<li>CPU处于忙状态所占时间的百分比。</li>
</ul>
</li>
<li><code>吞吐量</code>  =&gt;  增加吞吐量<ul>
<li>在单位时间内完成的进程数量。</li>
</ul>
</li>
<li><code>周转时间</code><ul>
<li>一个进程从初始化到结束，包括所有等待时间所花费的时间。</li>
</ul>
</li>
<li><code>等待时间</code>  =&gt;  减少等待时间<ul>
<li>进程在就绪队列中的总时间。</li>
</ul>
</li>
<li><code>响应时间</code>  =&gt;  减少响应时间<ul>
<li>从一个请求被提交到产生第一次响应所花费的总时间。</li>
</ul>
</li>
</ul>
<h3 id="3-2、调度算法"><a href="#3-2、调度算法" class="headerlink" title="3.2、调度算法"></a>3.2、调度算法</h3><ul>
<li><code>FCFS（First Come，FirstServer）</code>  先来先服务   不公平</li>
<li><code>SPN(SJF)</code>   短进程优先(短作业优先)   非抢占  不公平</li>
<li><code>SRT</code>   短剩余时间优先  可抢占  不公平</li>
<li>Shortest Process Next（Shortest Job First）Shortest Remaining Time </li>
<li><code>HRRN（Highest Response Ratio Next）</code>  最高响应比优先<ul>
<li>SPN 基础改进</li>
<li>不可抢占</li>
<li>关注进程等待时间</li>
<li>防止无限期推迟</li>
</ul>
</li>
<li><code>Round Robin</code>  轮循  公平<ul>
<li>时间量子太大  =&gt;  等待时间长，极端情况退化成 FCFS；</li>
<li>时间量子过小  =&gt;  吞吐量由于大量的上下文切换开销收到影响；</li>
<li>合理的时间量子 =&gt;  维持上下文切换开销处于 1% 以内 ；</li>
</ul>
</li>
<li><code>Multilevel Feedback Queues</code> （多级反馈队列）<ul>
<li>时间量子大小随优先级级别增加而增加，动态调整进程优先级；</li>
<li>如果任务在当前的时间量子中没有完成，则降到下一个优先级；</li>
<li>高优先级进程时间量子短，低优先级进程时间量子长；</li>
<li>等待时间越长，优先级升高。反之执行时间越长，优先级降低；</li>
<li>I/O 密集型任务停留在高优先级，CPU密集型任务的优先级下降很快；</li>
</ul>
</li>
<li><code>Fair Share Scheduing</code> （公平共享调度）</li>
</ul>
<h3 id="3-3、实时调度"><a href="#3-3、实时调度" class="headerlink" title="3.3、实时调度"></a>3.3、实时调度</h3><p><strong>强实时系统</strong></p>
<ul>
<li>需要在保证的时间内完成重要的任务，必须完成</li>
</ul>
<p><strong>弱实时系统</strong></p>
<ul>
<li>要求重要的进程的优先级更高，尽量完成，并非必须</li>
</ul>
<p><strong>RM (Rate Monotonic) 速率单调调度</strong></p>
<ul>
<li>最佳静态优先级调度</li>
<li>通过周期安排优先级</li>
<li>周期越短优先级越高</li>
<li>执行周期最短的任务</li>
</ul>
<p><strong>EDF (Earliest Deadline First) 最早期限调度</strong></p>
<ul>
<li>最佳的动态优先级调度</li>
<li>Deadl ine越早优先级越高</li>
<li>执行Deadl ine最早的任务</li>
</ul>
<h2 id="四、中断-竞态条件"><a href="#四、中断-竞态条件" class="headerlink" title="四、中断 竞态条件"></a>四、中断 竞态条件</h2><p><code>Critical section (临界区)：</code>临界区是指进程中的一段需要访问共享资源并且当另一个进程处于相应代码区域时便不会被执行的代码区域。同一时间临界区中最大存在一个线程。</p>
<p><code>Mutual exclusion (互斥)：</code>当一个进程处于临界区并访问共享资源时，没有其他进程会处于临界区并且访问任何相同的共享资源。</p>
<p><code>Dead lock (死锁)：</code>两个或以上的进程，在相互等待完成特定任务，最终没法将自身任务进行下去。</p>
<p><code>Starvation (饥饿)：</code>一个可执行进程，被调度器持续忽略以至于虽然处于可执行状态却不被执行。</p>
<h3 id="4-1、禁用硬件中断"><a href="#4-1、禁用硬件中断" class="headerlink" title="4.1、禁用硬件中断"></a>4.1、禁用硬件中断</h3><ul>
<li>没有中断，就没有上下文切换，因此就没有并发</li>
<li>进入临界区  =&gt;  禁止中断</li>
<li>离开临界区  =&gt;  开启中断</li>
<li>缺点：<ul>
<li>整个系统可能会为该进程停止；</li>
<li>导致其他线程处于饥饿状态；</li>
<li>无法限制响应中断所需的时间；</li>
<li>无法解决互斥问题；</li>
</ul>
</li>
</ul>
<h3 id="4-2、基于软件的解决方案"><a href="#4-2、基于软件的解决方案" class="headerlink" title="4.2、基于软件的解决方案"></a>4.2、基于软件的解决方案</h3><ul>
<li>编写代码</li>
</ul>
<h3 id="4-3、锁的抽象"><a href="#4-3、锁的抽象" class="headerlink" title="4.3、锁的抽象"></a>4.3、锁的抽象</h3><ul>
<li>硬件提供了一些原语；</li>
<li>OS 提供更高级的编程抽象 —&gt; 锁、信号量；</li>
<li>锁是抽象的数据结构，一个二进制状态；</li>
<li>提供互斥访问</li>
</ul>
<h2 id="五、信号量、管程"><a href="#五、信号量、管程" class="headerlink" title="五、信号量、管程"></a>五、信号量、管程</h2><h3 id="5-1、信号量的使用"><a href="#5-1、信号量的使用" class="headerlink" title="5.1、信号量的使用"></a>5.1、信号量的使用</h3><p><strong>抽象数据类型：一个整形（semaphore）， 两个原子操作</strong></p>
<ul>
<li><p><strong>P()：sem减1，如果 sem&lt; 0, 等待，否则继续；</strong></p>
</li>
<li><p><strong>V()：sem加1，如果 sem&lt;=0 ，唤醒一个等待的P；</strong></p>
</li>
<li><p>信号量是整数；</p>
</li>
<li><p>信号量是被保护的变量;</p>
<ul>
<li>初始化完成后，唯一改变一个信号量的值的办法是通过P()和V();</li>
<li>操作必须是原子；</li>
</ul>
</li>
<li><p>P()能够阻塞，V()不会阻塞；</p>
</li>
<li><p>两种类型信号量：</p>
<ul>
<li>二进制信号量：可以是 0 或 1；</li>
<li>一般/计数信号量：可取任何非负值；</li>
<li>两者相互表现（给定一个可以实现另一个）</li>
</ul>
</li>
<li><p>信号量可以用在2个方面</p>
<ul>
<li>互斥</li>
<li>条件同步（调度约束一个线程等待另一个线程的事情发生）</li>
</ul>
</li>
</ul>
<h3 id="5-2、管程"><a href="#5-2、管程" class="headerlink" title="5.2、管程"></a>5.2、管程</h3><p>目的：分离互斥和条件同步的关注。</p>
<p>什么是管程：</p>
<ul>
<li><p>包含了一系列共享变量，以及针对这些变量操作函数的组合；</p>
</li>
<li><p>一个锁：指定临界区，互斥性；一个管程只能有一个线程进入；</p>
</li>
<li><p>0或者多个条件变量：等待/通知信号量用于管理并发访问共享数据；</p>
</li>
</ul>
<h1 id="感谢阅读"><a href="#感谢阅读" class="headerlink" title="感谢阅读"></a>感谢阅读</h1>

        <hr>
        <!-- Pager -->
        <ul class="pager">
          
          <li class="previous">
            <a href="/2019/12/06/Java — String字符串/" data-toggle="tooltip" data-placement="top" title="String 字符串">&larr; Previous Post</a>
          </li>
          
          
          <li class="next">
            <a href="/2019/10/01/HashMapSourceCode/" data-toggle="tooltip" data-placement="top" title="HashMap Source Code">Next Post &rarr;</a>
          </li>
          
        </ul>

        
        <!-- tip start -->
        <div class="tip">
          <p>
            If you like this blog or find it useful for you, you are welcome to comment on it. You are also welcome to share this blog, so that more people can participate in it. If the images used in the blog infringe your copyright, please contact the author to delete them. Thank you !
          </p>
        </div>
        <!-- tip end -->
        

        
        <!-- Sharing Srtart -->
        <!-- Social Social Share Post -->
<!-- Docs:https://github.com/overtrue/share.js -->

<div class="social-share" data-initialized="true" data-disabled="tencent ,douban ,qzone ,linkedin ,facebook ,google ,diandian" data-wechat-qrcode-helper="" align="center">
  <ul class="list-inline text-center social-share-ul">
    <li class="social-share-li">
      <a target="_blank" class="social-share-icon icon-twitter">
        <i class="fa fa-twitter fa-1x" aria-hidden="true"></i>
      </a>
    </li>
    <li class="social-share-li">
      <a class="social-share-icon icon-wechat">
        <i class="fa fa-weixin fa-1x" aria-hidden="true"></i>
      </a>
    </li>
    <li class="social-share-li">
      <a target="_blank" class="social-share-icon icon-weibo">
        <i class="fa fa-weibo fa-1x" aria-hidden="true"></i>
      </a>
    </li>
    <li class="social-share-li">
      <a target="_blank" class="social-share-icon icon-qq">
        <i class="fa fa-qq fa-1x" aria-hidden="true"></i>
      </a>
    </li>
    <li class="social-share-li">
      <a target="_blank" class="social-share-icon" href="mailto:?subject=操作系统&body=Hi,I found this website and thought you might like it http://yoursite-url/2019/12/05/操作系统/">
        <i class="fa fa-envelope fa-1x" aria-hidden="true"></i>
      </a>
    </li>
  </ul>
</div>

<!-- css & js -->
<!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css"> -->
<script defer="defer" async="true" src="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script>

        <!-- Sharing End -->
        
        <hr>

        <!-- comments start -->
        <!-- 1. gitalk comment -->

<!-- gitalk start -->
<!-- Docs:https://github.com/gitalk/gitalk/blob/master/readme-cn.md -->

<div id="gitalk-container"></div>

<!-- <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.js"></script> -->
<script src="/js/comment/gitalk.js"></script>

<script>
  var gitalk = new Gitalk({
    clientID: '',
    clientSecret: '',
    repo: '',
    owner: '',
    admin: '',
    id: 'Thu Dec 05 2019 11:51:30 GMT+0800', // Ensure uniqueness and length less than 50
    distractionFreeMode: false, // Facebook-like distraction free mode
    perPage: 10 ,
    pagerDirection: 'last',
    createIssueManually: false ,
    language: 'en'
  });
  gitalk.render('gitalk-container');

  var gtFolded = () => {
    setTimeout(function() {
      let markdownBody = document.getElementsByClassName("markdown-body");
      let list = Array.from(markdownBody);
      list.forEach(item => {
        if (item.clientHeight > 250) {
          item.classList.add('gt-comment-body-folded');
          item.style.maxHeight = '250px';
          item.title = 'Click to Expand';
          item.onclick = function() {
            item.classList.remove('gt-comment-body-folded');
            item.style.maxHeight = '';
            item.title = '';
            item.onclick = null;
          };
        }
      })
    }, 800);
  }
</script>

<!-- gitalk end -->



<!-- 2. gitment comment -->



<!-- 3. disqus comment -->


        <!-- comments end -->
        <hr>

      </div>

      <!-- Catalog: Tabe of Content -->
      <!-- Table of Contents -->

    
      <aside id="sidebar">
        <div id="toc" class="toc-article">
        <strong class="toc-title">Contents</strong>
        
          <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#操作系统"><span class="toc-nav-number">1.</span> <span class="toc-nav-text">操作系统</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#一、"><span class="toc-nav-number">1.1.</span> <span class="toc-nav-text">一、</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#二、进程（Process）"><span class="toc-nav-number">1.2.</span> <span class="toc-nav-text">二、进程（Process）</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#2-1、进程的概念"><span class="toc-nav-number">1.2.1.</span> <span class="toc-nav-text">2.1、进程的概念</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#2-2、进程的组成"><span class="toc-nav-number">1.2.2.</span> <span class="toc-nav-text">2.2、进程的组成</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#2-3、进程与程序的联系"><span class="toc-nav-number">1.2.3.</span> <span class="toc-nav-text">2.3、进程与程序的联系</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#2-5、进程的特点"><span class="toc-nav-number">1.2.4.</span> <span class="toc-nav-text">2.5、进程的特点</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#2-6、进程控制块-PCB"><span class="toc-nav-number">1.2.5.</span> <span class="toc-nav-text">2.6、进程控制块 PCB</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#2-7、进程的生命周期"><span class="toc-nav-number">1.2.6.</span> <span class="toc-nav-text">2.7、进程的生命周期</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#2-7-1、进程生命周期管理"><span class="toc-nav-number">1.2.6.1.</span> <span class="toc-nav-text">2.7.1、进程生命周期管理</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#2-7-2、进程状态变化模型"><span class="toc-nav-number">1.2.6.2.</span> <span class="toc-nav-text">2.7.2、进程状态变化模型</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#2-7-3、进程挂起模式"><span class="toc-nav-number">1.2.6.3.</span> <span class="toc-nav-text">2.7.3、进程挂起模式</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#2-7-4、进程状态队列"><span class="toc-nav-number">1.2.6.4.</span> <span class="toc-nav-text">2.7.4、进程状态队列</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#2-7-5、进程的上下文切换"><span class="toc-nav-number">1.2.6.5.</span> <span class="toc-nav-text">2.7.5、进程的上下文切换</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#2-8、进程间通信-IPC"><span class="toc-nav-number">1.2.7.</span> <span class="toc-nav-text">2.8、进程间通信  IPC</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#共享内存"><span class="toc-nav-number">1.3.</span> <span class="toc-nav-text">共享内存</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#2-9、线程（Thread）"><span class="toc-nav-number">1.3.1.</span> <span class="toc-nav-text">2.9、线程（Thread）</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#2-9-1、线程的概念"><span class="toc-nav-number">1.3.1.1.</span> <span class="toc-nav-text">2.9.1、线程的概念</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#2-9-2、线程的实现"><span class="toc-nav-number">1.3.1.2.</span> <span class="toc-nav-text">2.9..2、线程的实现</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#2-9-3、死锁"><span class="toc-nav-number">1.3.1.3.</span> <span class="toc-nav-text">2.9..3、死锁</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#2-9-4、死锁恢复"><span class="toc-nav-number">1.3.1.4.</span> <span class="toc-nav-text">2.9..4、死锁恢复</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#三、调度"><span class="toc-nav-number">1.4.</span> <span class="toc-nav-text">三、调度</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#3-1、调度原则"><span class="toc-nav-number">1.4.1.</span> <span class="toc-nav-text">3.1、调度原则</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#3-2、调度算法"><span class="toc-nav-number">1.4.2.</span> <span class="toc-nav-text">3.2、调度算法</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#3-3、实时调度"><span class="toc-nav-number">1.4.3.</span> <span class="toc-nav-text">3.3、实时调度</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#四、中断-竞态条件"><span class="toc-nav-number">1.5.</span> <span class="toc-nav-text">四、中断 竞态条件</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#4-1、禁用硬件中断"><span class="toc-nav-number">1.5.1.</span> <span class="toc-nav-text">4.1、禁用硬件中断</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#4-2、基于软件的解决方案"><span class="toc-nav-number">1.5.2.</span> <span class="toc-nav-text">4.2、基于软件的解决方案</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#4-3、锁的抽象"><span class="toc-nav-number">1.5.3.</span> <span class="toc-nav-text">4.3、锁的抽象</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#五、信号量、管程"><span class="toc-nav-number">1.6.</span> <span class="toc-nav-text">五、信号量、管程</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#5-1、信号量的使用"><span class="toc-nav-number">1.6.1.</span> <span class="toc-nav-text">5.1、信号量的使用</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#5-2、管程"><span class="toc-nav-number">1.6.2.</span> <span class="toc-nav-text">5.2、管程</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#感谢阅读"><span class="toc-nav-number">2.</span> <span class="toc-nav-text">感谢阅读</span></a></li></ol>
        
        </div>
      </aside>
    


      <!-- Sidebar Container -->
      <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

        <!-- Featured Tags -->
        
        <section>
          <!-- no hr -->
          <h5>
            <a href="/tags/">FEATURED TAGS</a>
          </h5>
          <div class="tags">
            
            <a class="tag" href="/tags/#操作系统" title="操作系统">操作系统</a>
            
          </div>
        </section>
        

        <!-- Friends Blog -->
        
        <hr>
        <h5>FRIENDS</h5>
        <ul class="list-inline">

          
          <li>
            <a href="https://v-vincen.life/" target="_blank">V_Vincen</a>
          </li>
          
          <li>
            <a href="http://huangxuan.me" target="_blank">Hux Blog</a>
          </li>
          
          <li>
            <a href="https://hexo.io/" target="_blank">Hexo</a>
          </li>
          
          <li>
            <a href="https://yexua.github.io/" target="_blank">yexua</a>
          </li>
          
          <li>
            <a href="https://snailclimb.gitee.io/javaguide/#/" target="_blank">JavaGuide</a>
          </li>
          
          <li>
            <a href="http://cyc2018.gitee.io/cs-notes/#/notes/%E5%89%91%E6%8C%87%20Offer%20%E9%A2%98%E8%A7%A3%20-%20%E7%9B%AE%E5%BD%951" target="_blank">剑指Offer</a>
          </li>
          
          <li>
            <a href="http://cyc2018.gitee.io/cs-notes/#/" target="_blank">技术面试必备基础知识</a>
          </li>
          
        </ul>
        
      </div>
    </div>
  </div>
</article>



<!-- anchorjs start -->
<!-- async load function -->
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script type="text/javascript">
  // async load function
  function async (u, c) {
    var d = document,
      t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (c) {
      o.addEventListener('load', function(e) {
        c(null, e);
      }, false);
    }
    s.parentNode.insertBefore(o, s);
  };
</script>
<script type="text/javascript">
  //anchor-js, Doc:http://bryanbraun.github.io/anchorjs/
  async ("https://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js", function() {
    anchors.options = {
      visible: 'hover',
      placement: 'left',
      // icon: 'ℬ'
      icon: '❡'
    };
    anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
  });
</script>
<style>
  /* place left on bigger screen */
  @media all and (min-width: 800px) {
    .anchorjs-link {
      position: absolute;
      left: -0.75em;
      font-size: 1.1em;
      margin-top: -0.1em;
    }
  }
</style>

<!-- anchorjs end -->



	<!-- Footer (contains ThemeColor、viewer) -->
	<!-- Footer -->
<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center">
          

          
            <li>
              <a target="_blank" href="https://github.com/Github-yuteng">
                <span class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                </span>
              </a>
            </li>
          

          

          

          

          

          

          

        </ul>
        <p class="copyright text-muted">
          Copyright &copy;
          余腾
          2020
          <br>
          Theme by
          <a href="http://beantech.org" target="_blank" rel="noopener">BeanTech</a>
          <span style="display: inline-block; margin: 0 5px;">
            <i class="fa fa-heart"></i>
          </span>
          re-Ported by
          <a href="https://v-vincen.life/" target="_blank" rel="noopener">Live My Life</a>
          |
          <iframe style="margin-left: 2px; margin-bottom:-5px;" frameborder="0" scrolling="0" width="91px" height="20px" src="https://ghbtns.com/github-btn.html?user=V-Vincen&repo=V-Vincen.github.io&type=star&count=true"></iframe>
        </p>
      </div>
    </div>
  </div>
</footer>

<a id="rocket" href="#top" class=""></a>

<!-- jQuery -->
<script type="text/javascript" src="/js/jquery.min.js"></script>
<!-- <script type="text/javascript" src="/js/jquery.js"></script> -->
<!-- <script type="text/javascript" src="//cdnjs.loli.net/ajax/libs/jquery/3.2.1/jquery.min.js"></script> -->

<!-- Bootstrap Core JavaScript -->
<script type="text/javascript" src="/js/bootstrap.min.js"></script>

<!-- Custom Theme JavaScript -->
<script type="text/javascript" src="/js/hux-blog.min.js"></script>

<!-- catalog -->
<script type="text/javascript" async="true" src="/js/catalog.js?v=1.0.0"></script>

<!-- totop(rocket) -->
<script type="text/javascript" async="true" src="/js/totop.js?v=1.0.0"></script>

<!-- Busuanzi JavaScript -->
<script type="text/javascript" async="true" src="/js/busuanzi.pure.mini.js"></script>


  <!-- Scroll start -->
  <script type="text/javascript" src="/js/scroll.js"></script>
  <!-- Scroll end -->



  <!-- ThemeColor start -->
  <script type="text/javascript" src="/js/themecolor.js"></script>
  <!-- ThemeColor end -->





  <!-- viewer start -->
  <!-- viewer start (Picture preview) -->
  <script type="text/javascript" src="/js/viewer/viewer.min.js"></script>
  <script type="text/javascript" src="/js/viewer/pic-viewer.js"></script>
  <!-- viewer end -->


<script>
  // async load function
  function async (u, c) {
    var d = document,
      t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (c) {
      o.addEventListener('load', function (e) {
        c(null, e);
      }, false);
    }
    s.parentNode.insertBefore(o, s);
  }

  // fastClick.js
  async ("https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function () {
    var $nav = document.querySelector("nav");
    if ($nav)
      FastClick.attach($nav);
    }
  )
</script>

<!-- Because of the native support for backtick-style fenced code blocks right within the Markdown is landed in Github Pages, From V1.6, There is no need for Highlight.js, so Huxblog drops it officially. -
https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0 - https://help.github.com/articles/creating-and-highlighting-code-blocks/ -->
<!-- <script> async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){ hljs.initHighlightingOnLoad(); }) </script> <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet"> -->

<!-- jquery.tagcloud.js -->
<!-- <script> // only load tagcloud.js in tag.html if($('#tag_cloud').length !== 0){ async("http://yoursite-url/js/jquery.tagcloud.js",function(){ $.fn.tagcloud.defaults = { //size: {start: 1, end: 1, unit: 'em'}, color: {start:
'#bbbbee', end: '#0085a1'}, }; $('#tag_cloud a').tagcloud(); }) } </script> -->


	<!-- Search -->
	
	<div class="popup search-popup local-search-popup">
  <span class="popup-btn-close">
    ESC
  </span>
  <div class="container">
    <div class="row">
      <!-- <div class="col-md-9 col-md-offset-1"> -->
      <div class="col-lg-9 col-lg-offset-1 col-md-10 col-md-offset-1 local-search-content">

        <div class="local-search-header clearfix">

          <div class="local-search-input-wrapper">
            <span class="search-icon">
              <i class="fa fa-search fa-lg" style="margin: 25px 10px 25px 20px;"></i>
            </span>
            <input autocomplete="off" placeholder="Search..." type="text" id="local-search-input">
          </div>
        </div>
        <div id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>


  <script src="/js/ziploader.js"></script>
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.json";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    // monitor main search box;
    var onPopupClose = function (e) {
      $('.popup').fadeOut(300);
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $('.popup').fadeIn(300);
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }
    // get search zip version
    $.get('/searchVersion.json?t=' + (+new Date()), function (res) {
      if (localStorage.getItem('searchVersion') !== res) {
        localStorage.setItem('searchVersion', res);
        initSearchJson();
      }
    });

    function initSearchJson() {
      initLoad(['/search.flv'], {
        loadOptions: {
          success: function (obj) {
            localStorage.setItem('searchJson', obj['search.json'])
          },
          error: function (e) {
            return console.log(e)
          }
        },
        returnOptions: {
          'json': TYPE_TEXT
        },
        mimeOptions: {
          'json': 'application/json'
        }
      })
    }
    // search function;
    var searchFunc = function (search_id, content_id) {
      'use strict';
      isfetched = true;
      var datas = JSON.parse(localStorage.getItem('searchJson'));
      // console.log(search_id)
      var input = document.getElementById(search_id);
      var resultContent = document.getElementById(content_id);
      var inputEventFunction = function () {
        var searchText = input.value.trim().toLowerCase();
        var keywords = searchText.split(/[\s\-]+/);
        if (keywords.length > 1) {
          keywords.push(searchText);
        }
        var resultItems = [];
        if (searchText.length > 0) {
          // perform local searching
          datas.forEach(function (data) {
            var isMatch = false;
            var hitCount = 0;
            var searchTextCount = 0;
            var title = data.title
              ? data.title.trim()
              : '';
            var titleInLowerCase = title.toLowerCase();
            var content = data.content
              ? data.content.trim().replace(/<[^>]+>/g, "")
              : '';
            var contentInLowerCase = content.toLowerCase();
            var articleUrl = decodeURIComponent(data.url);

            var date = data.date;
            var dateTime = date.replace(/T/, " ").replace(/.000Z/, "");
            var imgUrl = data.header_img;

            var indexOfTitle = [];
            var indexOfContent = [];
            // only match articles with not empty titles
            keywords.forEach(function (keyword) {
              function getIndexByWord(word, text, caseSensitive) {
                var wordLen = word.length;
                if (wordLen === 0) {
                  return [];
                }
                var startPosition = 0,
                  position = [],
                  index = [];
                if (!caseSensitive) {
                  text = text.toLowerCase();
                  word = word.toLowerCase();
                }
                while ((position = text.indexOf(word, startPosition)) > -1) {
                  index.push({position: position, word: word});
                  startPosition = position + wordLen;
                }
                return index;
              }
              indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
              indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
            });
            if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
              isMatch = true;
              hitCount = indexOfTitle.length + indexOfContent.length;
            }
            // show search results
            if (isMatch) {
              // sort index by position of keyword
              [indexOfTitle, indexOfContent].forEach(function (index) {
                index.sort(function (itemLeft, itemRight) {
                  if (itemRight.position !== itemLeft.position) {
                    return itemRight.position - itemLeft.position;
                  } else {
                    return itemLeft.word.length - itemRight.word.length;
                  }
                });
              });
              // merge hits into slices
              function mergeIntoSlice(text, start, end, index) {
                var item = index[index.length - 1];
                var position = item.position;
                var word = item.word;
                var hits = [];
                var searchTextCountInSlice = 0;
                while (position + word.length <= end && index.length != 0) {
                  if (word === searchText) {
                    searchTextCountInSlice++;
                  }
                  hits.push({position: position, length: word.length});
                  var wordEnd = position + word.length;
                  // move to next position of hit
                  index.pop();
                  while (index.length != 0) {
                    item = index[index.length - 1];
                    position = item.position;
                    word = item.word;
                    if (wordEnd > position) {
                      index.pop();
                    } else {
                      break;
                    }
                  }
                }
                searchTextCount += searchTextCountInSlice;
                return {hits: hits, start: start, end: end, searchTextCount: searchTextCountInSlice};
              }
              var slicesOfTitle = [];
              if (indexOfTitle.length != 0) {
                slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
              }
              var slicesOfContent = [];
              while (indexOfContent.length != 0) {
                var item = indexOfContent[indexOfContent.length - 1];
                var position = item.position;
                var word = item.word;
                // cut out 100 characters
                var start = position - 20;
                var end = position + 80;
                if (start < 0) {
                  start = 0;
                }
                if (end < position + word.length) {
                  end = position + word.length;
                }
                if (end > content.length) {
                  end = content.length;
                }
                slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
              }
              // sort slices in content by search text's count and hits' count
              slicesOfContent.sort(function (sliceLeft, sliceRight) {
                if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                  return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                  return sliceRight.hits.length - sliceLeft.hits.length;
                } else {
                  return sliceLeft.start - sliceRight.start;
                }
              });
              // select top N slices in content
              var upperBound = parseInt('1');
              if (upperBound >= 0) {
                slicesOfContent = slicesOfContent.slice(0, upperBound);
              }
              // highlight title and content
              function highlightKeyword(text, slice) {
                var result = '';
                var prevEnd = slice.start;
                slice.hits.forEach(function (hit) {
                  result += text.substring(prevEnd, hit.position);
                  var end = hit.position + hit.length;
                  result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                  prevEnd = end;
                });
                result += text.substring(prevEnd, slice.end);
                return result;
              }
              var resultItem = '';

              // if (slicesOfTitle.length != 0) {   resultItem += "<li><a target='_blank' href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>"; } else {   resultItem += "<li><a target='_blank' href='" +
              // articleUrl + "' class='search-result-title'>" + title + "</a>"; } slicesOfContent.forEach(function (slice) {   resultItem += "<a target='_blank' href='" + articleUrl + "'><p class=\"search-result\">" + highlightKeyword(content, slice) +
              // "...</p></a>"; }); resultItem += "</li>";

              if (slicesOfTitle.length != 0) {
                resultItem += "<a target='_blank' href='" + articleUrl + "' class='search-result'><div class='search-result-left'><div class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</div><time class='search-result-date'>" + dateTime + "</time>";
              } else {
                resultItem += "<a target='_blank' href='" + articleUrl + "' class='search-result'><div class='search-result-left'><div class='search-result-title'>" + title + "</div><time class='search-result-date'>" + dateTime + "</time>";
              }
              slicesOfContent.forEach(function (slice) {
                resultItem += "<p class=\"search-result-content\">" + highlightKeyword(content, slice) + "...</p>";
              });
              resultItem += "</div><div class='search-result-right'><img class='media-image' src='" + imgUrl + "' width='64px' height='48px'></img></div></a>";

              resultItems.push({item: resultItem, searchTextCount: searchTextCount, hitCount: hitCount, id: resultItems.length});
            }
          })
        };

        if (keywords.length === 1 && keywords[0] === "") {
          resultContent.innerHTML = '<div id="no-result"></div>'
        } else if (resultItems.length === 0) {
          resultContent.innerHTML = '<div id="no-result"></div>'
        } else {
          resultItems.sort(function (resultLeft, resultRight) {
            if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
              return resultRight.searchTextCount - resultLeft.searchTextCount;
            } else if (resultLeft.hitCount !== resultRight.hitCount) {
              return resultRight.hitCount - resultLeft.hitCount;
            } else {
              return resultRight.id - resultLeft.id;
            }
          });
          var searchResultList = '<div class=\"search-result-list\">';
          resultItems.forEach(function (result) {
            searchResultList += result.item;
          })
          searchResultList += "</div>";
          resultContent.innerHTML = searchResultList;
        }
      }
      if ('auto' === 'auto') {
        input.addEventListener('input', inputEventFunction);
      } else {
        $('.search-icon').click(inputEventFunction);
        input.addEventListener('keypress', function (event) {
          if (event.keyCode === 13) {
            inputEventFunction();
          }
        });
      }
      // remove loading animation
      $('body').css('overflow', '');
      proceedsearch();
    }
    // handle and trigger popup window;
    $('.popup-trigger').click(function (e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc('local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });
    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function (e) {
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 && $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });

    document.addEventListener('mouseup', (e) => {
      var _con = document.querySelector(".local-search-content");
      if (_con) {
        if (!_con.contains(e.target)) {
          onPopupClose();
        }
      }
    });
  </script>


	

	<!-- Image to hack wechat -->
	<!-- <img src="http://yoursite-url/img/icon_wechat.png" width="0" height="0" /> -->
	<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>
